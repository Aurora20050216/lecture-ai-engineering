# 要件定義書  
## 講義書き起こし修正AI

---

## 1. 目的・背景

講義の自動書き起こし結果は、ドメイン固有語の誤認識、言い直し、どもりなどが多く、読みやすい文章とは言い難い。  
本プロジェクトでは、講義スライド資料（.pptx）を併用し、Bedrock上のLLMによって自動整形を行い、自然で読みやすい文書に修正することを目的とする。

---

## 2. 対象ユーザー

- 教員：講義内容の書き起こしを行う担当者

---

## 3. システム概要

### 概要  
ユーザーが `.txt`（文字起こし）と`.pptx`（講義資料）をアップロードすると、整形された `.txt` ファイルがダウンロード可能になる。

### 流れ

```plaintext
[INPUT]
・講義資料（.pptx）1件
・文字起こしファイル（.txt）1件

        ↓

[処理内容]
1. .pptxファイルからスライドテキストを抽出
2. .txtファイルの発話をチャンクに分割（文単位など）
3. 各チャンクとスライド文の類似度マッチング（SBERT）
4. マッチしたスライド文を補助としてLLMに渡し、発話を整形
5. 整形済みテキストを出力

        ↓

[OUTPUT]
・整形済みの.txt（句読点あり、自然文）
```

---

## 4. 機能要件

| 種別           | 拡張子 | 内容                              |
|----------------|--------|----------------------------------|
| 講義資料       | `.pptx`| スライドテキスト                 |
| 音声文字起こし | `.txt` | 自動書き起こし結果の連続文（句読点なし可）  |

### 出力ファイル

| 種別          | 拡張子 | 内容                           |
|---------------|--------|-------------------------------|
| 整形済講義文  | `.txt` | 読みやすい句読点付き整形文（スライド準拠） |

---

## 5. 非機能要件

- **処理性能**  
  1時間分の講義データ（約10,000〜15,000文字）を5分以内に整形処理完了  
- **同時処理数**  
  初期は1件対応、将来的にはバッチ処理検討  
- **可用性**  
  非同期バッチ処理方式。処理完了後、ファイルをS3等からダウンロード可能  
- **拡張性**  
  複数スライドファイル、複数講義対応を将来的に考慮  

---

## 6. 使用技術スタック

| 項目           | 技術・サービス                        |
|----------------|-------------------------------------|
| LLM            | Bedrock (Claude, Titan など)         |
| 類似度評価     | SBERT (AWS Lambda / EC2上で動作想定) |
| スライド解析   | `python-pptx`                       |
| バックエンド   | FastAPI または AWS Lambda / API Gateway |
| フロントエンド | React / Vue / その他 SPAフレームワーク
| ストレージ     | Amazon S3                          |
| 非同期通知     | Amazon SNS / SQS（任意）            |
| 認証・アクセス管理 | Amazon Cognito またはIAM権限管理（任意） |

---

## 7. LLMプロンプト設計（概要）

```plaintext
### Instruction:
以下は講義の文字起こしです。この文章には口語、どもり、言い直し、スライドの文の読み上げなどが含まれています。
対応するスライドテキストと照合して、内容を忠実に維持しながら、整った自然な文に変換してください。

### Slide Content:
{対応スライド文}

### Original Transcript:
{該当の文字起こしチャンク}

### Output:
{整形済み文章}
```

---

## 8. 評価方法

| 指標          | 方法                                       |
|---------------|--------------------------------------------|
| 類似度評価    | 整形後文とスライド文のBERTScore             |
| 文法品質      | LanguageToolなどで誤検出件数をカウント       |
| 整形効果      | 元文との編集距離（Levenshtein距離）による変化量 |

---

## 9. スケジュール（例）

| フェーズ               | 内容                               | 期間        |
|------------------------|----------------------------------|-------------|
| 設計・プロンプトチューニング | プロトタイプ開発・1講義で実験       | 3日    |
| MVP構築                | S3連携・Bedrock統合               | 2日    |
| デプロイ・評価         | 実運用評価・改善                   | 3日    |

---

## 10. 備考

- `.pptx`ファイルの構造によっては画像ベースのスライドには対応不可（OCR連携は別途検討）  
- 非同期処理の通知は任意。即時ダウンロード可能なら不要  

---

## 11. Webアプリケーション要件

### 11.1 入力UI

- ユーザーがブラウザ上で以下のファイルをアップロード可能  
  - 講義資料ファイル（`.pptx`）  
  - 文字起こしファイル（`.txt`）

- 複数ファイルアップロードは初期対応外（将来検討）

### 11.2 バックエンド処理

- 受け取ったファイルをAWS上のAPIに送信し、処理を開始  
- 処理完了までの進捗表示（プログレスバー or スピナー）

### 11.3 出力UI

- 処理完了後、整形済み `.txt` ファイルのダウンロードリンクを画面に表示  
- ダウンロードはワンクリックで実行可能  
- 複数回の処理履歴は初期対応なし（将来拡張予定）

### 11.4 システム構成例

- フロントエンド：React/Vue等のSPA  
- バックエンド：FastAPI or AWS Lambda + API Gateway  
- ファイル保存：Amazon S3（一時保存）  
- 処理状態管理：WebSocketやポーリングによる進捗通知

---

### バージョン情報

| バージョン | 日付       | 担当者   | 変更内容                      |
|------------|------------|----------|------------------------------|
| 1.0        | 2025-06-22 | Aurora20050216  | 初版作成                     |
| 1.1        | 2025-06-22 | Aurora20050216  | 書式修正                     |
| 2.0        | 2025-06-22 | Aurora20050216  | Webアプリケーション要件の追加  |